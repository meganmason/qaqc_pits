import datetime
import glob
import os
import shutil
import numpy as np
import pandas as pd
from pathlib import Path


fname_dict = {
"20191220_CAAMCL": "1300",
"20200131_CAAMCL": "1215",
"20200214_CAAMCL": "1200",
"20200221_CAAMCL": "1200",
"20200228_CAAMCL": "1130",
"20200306_CAAMCL": "1145",
"20200313_CAAMCL": "1030",
"20191218_CAMLCP": "1108",
"20200122_CAMLCP": "1000",
"20200129_CAMLCP": "0950",
"20200206_CAMLCP": "1335",
"20200212_CAMLCP": "1015",
"20200219_CAMLCP": "1005",
"20200226_CAMLCP": "0954",
"20200304_CAMLCP": "1028",
"20200311_CAMLCP": "0908",
"20191218_CAMLPD": "1128",
"20200124_CAMLPD": "0945",
"20200129_CAMLPD": "1030",
"20200205_CAMLPD": "1000",
"20200212_CAMLPD": "1029",
"20200219_CAMLPD": "1015",
"20191220_CASHFO": "1231",
"20200129_CASHFO": "1053",
"20200212_CASHFO": "0919",
"20200219_CASHFO": "1000",
"20200226_CASHFO": "1000",
"20200304_CASHFO": "0925",
"20200311_CASHFO": "0823",
"20191220_CASHOP": "1123",
"20200129_CASHOP": "1057",
"20200212_CASHOP": "0938",
"20200219_CASHOP": "1021",
"20200226_CASHOP": "1016",
"20200304_CASHOP": "0957",
"20200311_CASHOP": "0850",
"20200129_CASHT4": "1415",
"20200212_CASHT4": "1050",
"20200219_CASHT4": "1230",
"20200226_CASHT4": "1201",
"20200304_CASHT4": "1058",
"20200311_CASHT4": "1045",
"20191218_COCPJW": "1125",
"20200124_COCPJW": "1135",
"20200131_COCPJW": "1000",
"20200212_COCPJW": "1108",
"20200219_COCPJW": "1004",
"20200226_COCPJW": "0947",
"20200304_COCPJW": "0927",
"20200311_COCPJW": "0900",
"20191218_COCPMR": "1350",
"20200124_COCPMR": "1115",
"20200131_COCPMR": "1200",
"20200212_COCPMR": "1348",
"20200219_COCPMR": "1314",
"20200226_COCPMR": "0949",
"20200304_COCPMR": "1229",
"20200311_COCPMR": "1200",
"20200201_COER12": "1154",
"20200201_COER12": "1232",
"20200201_COER12": "1305",
"20200226_COER12": "1226",
"20200226_COER12": "1241",
"20200226_COER12": "1242",
"20200428_COER12": "1400",
"20200428_COER12": "1415",
"20200428_COER12": "1445",
"20200512_COER12": "1030",
"20200512_COER12": "1045",
"20200512_COER12": "1100",
"20200226_COER13": "1115",
"20200226_COER13": "1130",
"20200226_COER13": "1155",
"20200428_COER13": "1230",
"20200428_COER13": "1245",
"20200428_COER13": "1300",
"20200512_COER13": "1115",
"20200512_COER13": "1130",
"20200512_COER13": "1200",
"20200201_COER14": "1040",
"20200201_COER14": "1300",
"20200201_COER14": "1350",
"20200226_COER14": "1007",
"20200226_COER14": "1024",
"20200226_COER14": "1040",
"20200428_COER14": "1015",
"20200428_COER14": "1045",
"20200428_COER14": "1115",
"20200512_COER14": "1230",
"20200512_COER14": "1300",
"20200512_COER14": "1330",
"20200201_COERAP": "1524",
"20200201_COERAP": "1550",
"20200201_COERAP": "1610",
"20200226_COERAP": "1550",
"20200226_COERAP": "1600",
"20200427_COERAP": "0845",
"20200427_COERAP": "0930",
"20200427_COERAP": "1015",
"20200512_COERAP": "1430",
"20191218_COERGT": "1316",
"20200117_COERGT": "1015",
"20200124_COERGT": "1205",
"20200129_COERGT": "0940",
"20200205_COERGT": "0945",
"20200212_COERGT": "1400",
"20200219_COERGT": "1500",
"20200226_COERGT": "1020",
"20200311_COERGT": "1025",
"20191219_COERIB": "1110",
"20200117_COERIB": "1030",
"20200122_COERIB": "1200",
"20200129_COERIB": "1145",
"20200205_COERIB": "1140",
"20200212_COERIB": "1145",
"20200219_COERIB": "1130",
"20200226_COERIB": "1145",
"20200312_COERIB": "0938",
"20200408_COERIB": "1042",
"20200422_COERIB": "1130",
"20200506_COERIB": "1132",
"20200520_COERIB": "0930",
"20200201_COERO2": "0950",
"20200201_COERO2": "1120",
"20200201_COERO2": "1220",
"20200226_COERO2": "1000",
"20200226_COERO2": "1018",
"20200226_COERO2": "1120",
"20200427_COERO2": "1145",
"20200427_COERO2": "1215",
"20200427_COERO2": "1245",
"20200201_COERO4": "1000",
"20200201_COERO4": "1115",
"20200201_COERO4": "1215",
"20200226_COERO4": "1230",
"20200226_COERO4": "1330",
"20200226_COERO4": "1425",
"20200428_COERO4": "0830",
"20200428_COERO4": "0900",
"20200428_COERO4": "0915",
"20200513_COERO4": "0845",
"20200513_COERO4": "0900",
"20200513_COERO4": "0915",
"20200201_COERO6": "1400",
"20200201_COERO6": "1430",
"20200201_COERO6": "1500",
"20200226_COERO6": "1428",
"20200226_COERO6": "1458",
"20200226_COERO6": "1459",
"20200427_COERO6": "1345",
"20200427_COERO6": "1430",
"20200427_COERO6": "1445",
"20200202_COERTR": "1032",
"20200202_COERTR": "1033",
"20200202_COERTR": "1034",
"20200202_COERTR": "1031",
"20200202_COERTR": "1030",
"20200202_COERUP": "1030",
"20200202_COERUP": "1120",
"20200202_COERUP": "1215",
"20200226_COERUP": "1310",
"20200226_COERUP": "1330",
"20200226_COERUP": "1400",
"20200429_COERUP": "1030",
"20200429_COERUP": "1115",
"20200429_COERUP": "1130",
"20200512_COERUP": "0900",
"20200512_COERUP": "0930",
"20200512_COERUP": "0945",
"20191219_COFEB1": "1404",
"20200131_COFEB1": "1230",
"20200205_COFEB1": "1300",
"20200212_COFEB1": "1030",
"20200221_COFEB1": "1350",
"20200226_COFEB1": "1350",
"20200304_COFEB1": "1530",
"20200311_COFEB1": "1200",
"20191219_COFEB2": "1510",
"20200131_COFEB2": "1304",
"20200205_COFEB2": "1419",
"20200212_COFEB2": "1120",
"20200221_COFEB2": "1450",
"20200226_COFEB2": "1440",
"20191024_COFEJ1": "1243",
"20191029_COFEJ1": "1210",
"20191124_COFEJ1": "1112",
"20191203_COFEJ1": "1208",
"20191210_COFEJ1": "1158",
"20191216_COFEJ1": "1130",
"20191219_COFEJ1": "1100",
"20191223_COFEJ1": "1120",
"20191230_COFEJ1": "1115",
"20200104_COFEJ1": "1110",
"20200119_COFEJ1": "1040",
"20200124_COFEJ1": "1200",
"20200131_COFEJ1": "1030",
"20200205_COFEJ1": "1044",
"20200210_COFEJ1": "1300",
"20200212_COFEJ1": "1342",
"20200221_COFEJ1": "1105",
"20200226_COFEJ1": "1208",
"20200304_COFEJ1": "1220",
"20200311_COFEJ1": "0915",
"20200318_COFEJ1": "1440",
"20191024_COFEJ2": "1322",
"20191029_COFEJ2": "1254",
"20191124_COFEJ2": "1155",
"20191203_COFEJ2": "1310",
"20191210_COFEJ2": "1245",
"20191216_COFEJ2": "1232",
"20191230_COFEJ2": "1227",
"20200104_COFEJ2": "1200",
"20200108_COFEJ2": "1208",
"20200119_COFEJ2": "1140",
"20200205_COFEJ2": "1200",
"20200210_COFEJ2": "1345",
"20200221_COFEJ2": "1145",
"20200304_COFEJ2": "1320",
"20200311_COFEJ2": "1030",
"20200318_COFEJ2": "1400",
"20191219_COGMCO": "1220",
"20191220_COGMCO": "1030",
"20200122_COGMCO": "1015",
"20200131_COGMCO": "0830",
"20200212_COGMCO": "0852",
"20200219_COGMCO": "0930",
"20200226_COGMCO": "0715",
"20200304_COGMCO": "0921",
"20200312_COGMCO": "0850",
"20200318_COGMCO": "0825",
"20200325_COGMCO": "1015",
"20200417_COGMCO": "1509",
"20191219_COGMCT": "1420",
"20200122_COGMCT": "1225",
"20200131_COGMCT": "1016",
"20200212_COGMCT": "1030",
"20200219_COGMCT": "1115",
"20200226_COGMCT": "0855",
"20200304_COGMCT": "1252",
"20200312_COGMCT": "1030",
"20200318_COGMCT": "1005",
"20200325_COGMCT": "1230",
"20191219_COGMSO": "1600",
"20200122_COGMSO": "1455",
"20200131_COGMSO": "1225",
"20200212_COGMSO": "1252",
"20200219_COGMSO": "1340",
"20200225_COGMSO": "1500",
"20200304_COGMSO": "1550",
"20200306_COGMSO": "1705",
"20200312_COGMSO": "1520",
"20200321_COGMSO": "0930",
"20200328_COGMSO": "0900",
"20200328_COGMSO": "1630",
"20200406_COGMSO": "0650",
"20200406_COGMSO": "1600",
"20200419_COGMSO": "1600",
"20200421_COGMSO": "0553",
"20200421_COGMSO": "1626",
"20200422_COGMSO": "1512",
"20200503_COGMSO": "0602",
"20200503_COGMSO": "1610",
"20200122_COGMST": "1655",
"20200131_COGMST": "1423",
"20200212_COGMST": "1430",
"20200219_COGMST": "1500",
"20200225_COGMST": "1640",
"20200306_COGMST": "1815",
"20200312_COGMST": "1345",
"20200321_COGMST": "1155",
"20200328_COGMST": "0715",
"20200328_COGMST": "1430",
"20200401_COGMST": "0900",
"20200401_COGMST": "1535",
"20200418_COGMST": "1217",
"20200421_COGMST": "0726",
"20200421_COGMST": "1507",
"20200422_COGMST": "1618",
"20200503_COGMST": "0653",
"20200503_COGMST": "1732",
"20200305_COGMWO": "0809",
"20200316_COGMWO": "0841",
"20200316_COGMWO": "1358",
"20200316_COGMWO": "1519",
"20200331_COGMWO": "0934",
"20200331_COGMWO": "1530",
"20200408_COGMWO": "1551",
"20200409_COGMWO": "0550",
"20200409_COGMWO": "1218",
"20200409_COGMWO": "1615",
"20200305_COGMWT": "0935",
"20200316_COGMWT": "1050",
"20200316_COGMWT": "1228",
"20200331_COGMWT": "1145",
"20200331_COGMWT": "1310",
"20200409_COGMWT": "0725",
"20200409_COGMWT": "1440",
"20191218_CONWC1": "0915",
"20200122_CONWC1": "1145",
"20200129_CONWC1": "1020",
"20200205_CONWC1": "1020",
"20200212_CONWC1": "0910",
"20200219_CONWC1": "0930",
"20200226_CONWC1": "0820",
"20200304_CONWC1": "0903",
"20200311_CONWC1": "0716",
"20200122_CONWFF": "1010",
"20200122_CONWFF": "1020",
"20200122_CONWFF": "1025",
"20200212_CONWFF": "1110",
"20200212_CONWFF": "1145",
"20200311_CONWFF": "0900",
"20200311_CONWFF": "0920",
"20200311_CONWFF": "0945",
"20200422_CONWFF": "1310",
"20200513_CONWFF": "0930",
"20200513_CONWFF": "0955",
"20200513_CONWFF": "1030",
"20200122_CONWFN": "1230",
"20200122_CONWFN": "1231",
"20200122_CONWFN": "1245",
"20200212_CONWFN": "1335",
"20200311_CONWFN": "1100",
"20200311_CONWFN": "1101",
"20200311_CONWFN": "1130",
"20200513_CONWFN": "0944",
"20200513_CONWFN": "1000",
"20200513_CONWFN": "1024",
"20200513_CONWFN": "1048",
"20200122_CONWFS": "1400",
"20200122_CONWFS": "1405",
"20200122_CONWFS": "1406",
"20200212_CONWFS": "1040",
"20200212_CONWFS": "1100",
"20200212_CONWFS": "1108",
"20200311_CONWFS": "0930",
"20200311_CONWFS": "0931",
"20200311_CONWFS": "1010",
"20200513_CONWFS": "0915",
"20200513_CONWFS": "0930",
"20200513_CONWFS": "0945",
"20200513_CONWFS": "1000",
"20200122_CONWOF": "1100",
"20200122_CONWOF": "1115",
"20200122_CONWOF": "1140",
"20200212_CONWOF": "1254",
"20200212_CONWOF": "1300",
"20200212_CONWOF": "1310",
"20200311_CONWOF": "1100",
"20200311_CONWOF": "1118",
"20200311_CONWOF": "1145",
"20200422_CONWOF": "1054",
"20200422_CONWOF": "1155",
"20200513_CONWOF": "1050",
"20200513_CONWOF": "1105",
"20200513_CONWOF": "1115",
"20200513_CONWOF": "1130",
"20191218_CONWSA": "1300",
"20200129_CONWSA": "1030",
"20200205_CONWSA": "1145",
"20200212_CONWSA": "1045",
"20200219_CONWSA": "1032",
"20200226_CONWSA": "1016",
"20200304_CONWSA": "1006",
"20191218_COSBSA": "0915",
"20200122_COSBSA": "1235",
"20200129_COSBSA": "1205",
"20200212_COSBSA": "1236",
"20200219_COSBSA": "1446",
"20200226_COSBSA": "1444",
"20200304_COSBSA": "1410",
"20200311_COSBSA": "1125",
"20191218_COSBSB": "1415",
"20200201_COSBSB": "0950",
"20200219_COSBSB": "1240",
"20200226_COSBSB": "1250",
"20200304_COSBSB": "1215",
"20191218_IDBRBO": "1424",
"20200109_IDBRBO": "1411",
"20200123_IDBRBO": "1430",
"20200130_IDBRBO": "1340",
"20200206_IDBRBO": "1300",
"20200213_IDBRBO": "1230",
"20200219_IDBRBO": "1222",
"20200227_IDBRBO": "1240",
"20200305_IDBRBO": "1245",
"20200312_IDBRBO": "1215",
"20191218_IDBRBS": "1000",
"20200109_IDBRBS": "1030",
"20200123_IDBRBS": "1100",
"20200130_IDBRBS": "1200",
"20200206_IDBRBS": "1200",
"20200213_IDBRBS": "1130",
"20200219_IDBRBS": "1045",
"20200227_IDBRBS": "1030",
"20200305_IDBRBS": "1040",
"20200312_IDBRBS": "1000",
"20191219_IDBRBU": "1000",
"20200108_IDBRBU": "1155",
"20200116_IDBRBU": "1100",
"20200124_IDBRBU": "1315",
"20200131_IDBRBU": "1330",
"20200207_IDBRBU": "1230",
"20200214_IDBRBU": "1230",
"20200220_IDBRBU": "1100",
"20200226_IDBRBU": "1445",
"20200304_IDBRBU": "1455",
"20200311_IDBRBU": "1400",
"20200122_IDBRLO": "1512",
"20200131_IDBRLO": "0926",
"20200212_IDBRLO": "1519",
"20200220_IDBRLO": "0845",
"20200226_IDBRLO": "0928",
"20200304_IDBRLO": "1210",
"20200311_IDBRLO": "0930",
"20200122_IDBRLT": "1324",
"20200131_IDBRLT": "1115",
"20200212_IDBRLT": "1400",
"20200220_IDBRLT": "1042",
"20200226_IDBRLT": "1115",
"20200304_IDBRLT": "1111",
"20200311_IDBRLT": "1117",
"20200212_IDBRMC": "1100",
"20200311_IDBRMC": "1100",
"20191220_NMJRBA": "1450",
"20200122_NMJRBA": "1420",
"20200129_NMJRBA": "1119",
"20200205_NMJRBA": "1114",
"20200212_NMJRBA": "1337",
"20200220_NMJRBA": "1234",
"20200226_NMJRBA": "1139",
"20200304_NMJRBA": "1116",
"20191220_NMJRHQ": "1100",
"20200122_NMJRHQ": "1115",
"20200129_NMJRHQ": "1026",
"20200205_NMJRHQ": "1100",
"20200212_NMJRHQ": "1305",
"20200220_NMJRHQ": "1156",
"20200226_NMJRHQ": "1157",
"20200304_NMJRHQ": "1105",
"20200124_UTLCAC": "1222",
"20200131_UTLCAC": "1130",
"20200213_UTLCAC": "1345",
"20200220_UTLCAC": "1400",
"20200227_UTLCAC": "1000",
"20200305_UTLCAC": "1100",
"20200312_UTLCAC": "0930",
"20200124_UTLCAW": "1100",
"20200131_UTLCAW": "1200",
"20200213_UTLCAW": "1510",
"20200220_UTLCAW": "1350",
"20200227_UTLCAW": "1145",
"20200305_UTLCAW": "1230",
"20200312_UTLCAW": "1248"
}


# path = Path('/Users/mamason6/Google Drive/My Drive/SnowEx-2020/SnowEx-2020-timeseries-pits/timeseries_protocol_photos') #site photos
#
# for i, filename in enumerate(sorted(path.rglob('*.jpg'))):
#     # print(i, filename.stem)
#
#     directory = filename.parent #dir
#     fname_parse = filename.stem.split('_') # parse the parts of the filename
#     dict_key = fname_parse[3] + '_' + fname_parse[4] # create dict key to match fname_dict key (pitID_yyymmdd), give you the time!
#     time_str = fname_dict.get(dict_key)
#     fname_parse.insert(4, time_str) # add time after date string (4th position)
#     newname = '_'.join(fname_parse) + filename.suffix
#     print(Path(directory, newname))
#     filename.rename(Path(directory, newname))
#
# print('script donzo!')

path = Path('/Users/mamason6/Google Drive/My Drive/SnowEx-2020/SnowEx-2020-timeseries-pits/timeseries_pitbook_photos') #book photos

for i, filename in enumerate(sorted(path.rglob('*.jpg'))):

    if len(filename.stem.split('_')) > 7: #ime already added to filename. Skip all Grand Mesa TS pits.
        # print('skipping because time is already part of : ', i, filename.stem)
        pass

    else:
        # print(i, filename.stem)

        directory = filename.parent #dir
        fname_parse = filename.stem.split('_') # parse the parts of the filename
        dict_key = fname_parse[3] + '_' + fname_parse[4] # create dict key to match fname_dict key (pitID_yyymmdd), give you the time!
        time_str = fname_dict.get(dict_key)
        fname_parse.insert(4, time_str) # add time after date string (4th position)
        newname = '_'.join(fname_parse) + filename.suffix
        print(Path(directory, newname))
        filename.rename(Path(directory, newname))
# #
# print('script donzo!')
